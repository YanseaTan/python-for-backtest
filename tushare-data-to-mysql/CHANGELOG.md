# 更新日志

## todo

## bug

## 2023-11-21

- 去除价差中毛刺时新增对成交量的判断，若成交量小于 1000 手则删除该毛刺，避免删除有效数据。
- 品种配置文件中新增了仓单注销月份的数据。

## 2023-11-20

- 升级计算推荐价差的脚本，对不同年份的价差分别去除最后一个交割月的数据，避免交割月价格波动对推荐价差的影响。

## 2023-11-17

- 新增抓取天风 api 接口中期货基本面数据的脚本以及相关的配置文件。
- 升级了将价差数据写入 excel 文件的脚本，新增了对所有合约组合的支持，并进行了清洗数据的测试。
- 升级了计算推荐价差的算法，去除了毛刺数据，并同时新增了对所有合约组合的支持。

## 2023-11-15

- 计算所有跨月组合的价差数据。
- 在数据库中为 fut_code 和 spread_type 加索引，大大提升了查询效率，进而加速了脚本速度（37.85s -> 0.03s）。
- 插入价差数据至 Excel 改用二维数组的方式插入，大大加快了 Excel 文件的生成速度。
- 输出文件时会进行文件路径判断以及自动创建该日期下的路径。
- 测试 Excel 打开和不打开情况下脚本的写入效率，发现前台打开 Excel 的写入速度更快（后台打开可能分配的资源也较少）。

## 2023-11-13

- 新增 get_trade_date_set 函数，获取所有日行情数据库中缺少的交易日期合集，方便随时更新数据。

## 2023-10-24

- 在 TushareDataToMySQL 中新增更新三大市场（股票，可转债，期货）合约基本信息的功能，并加入至每日更新方法之中。
- 将输出的期货价差季节性走势表格中的数据限制为近四年数据。
- 新增获取指定交易日所有合约组合的日行情价差数据方法。

## 2023-10-23

- 将 TushareDataToMySQL 中获取昨天日期的方法更新为获取上一交易日，使脚本更加完善。
- 将未达到到期日的期货合约组合价差信息也导入到数据库中，使季节性走势中可体现出最新的价差和价格数据。
- 优化输出表格的显示效果，包括使最近年份的的趋势线更加明显以及横坐标单位值调整等。

## 2023-10-20

- 新增将指定品种不同跨月组合价差季节性走势数据导出到 Excel 的功能。
- 删除了 read_data 中多余的参数。
- 修改了生成 ProductOps 配置文件的格式。

## 2023-10-18

- 新增 DatabaseTools 文件，用于存放所有与数据库操作相关的函数，供其他文件调用。
- 将写入价差数据至 excel 中的功能迁移到了 WriteSpreadDataToXlsx 文件中，降低文件间功能的耦合性。
- 新增 UpdateSpreadConfig 文件，通过数据库中的期货价差日行情数据，统计分析得到所有品种下所有跨月组合 10% 最低价差，并以此更新行情服务器所需的价差配置文件。

## 2023-10-17

- 新增了获取指定品种在指定到期日区间内所有的相邻月组合列表函数。
- 修改了 FuturesMDToSpread 模块中导入价差数据的方式为单条数据插入，避免重复插入数据时报错中断整体运行。
- 组合合约价差日行情数据新增品种和跨月类型字段，方便后续进行分类。
- 完成了将所有合约组合在重合交易日的价差数据存入数据库的功能。
- 完成将所有组合合约价差数据导出到 excel 中，并插入图表的功能。

## 2023-10-16

- 新增每日更新期货日行情数据时，去除对主力/连续行情的存储。

## 2023-10-13

- 添加 FuturesMDToSpread 模块，可通过数据库中的期货合约日行情数据，计算所有期货合约日行情价差并存入数据库。
- FuturesMDToSpread 模块新增绘制图像的能力。

## 2023-10-12

- 去除了获取期货历史日行情时对各期货公司主力/连续合约数据的查询和存储。
- 新增每日将各类日行情自动导入对应的表中的方法。

## 2023-10-11

- 新增获取股票、可转债、期货基本信息，以及可转债和期货所有历史日行情的方法。